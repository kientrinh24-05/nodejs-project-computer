<style>
  .select-pure__select {
    align-items: center;
    background: #f9f9f8;
    border-radius: 4px;
    border: 1px solid rgba(0, 0, 0, 0.15);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
    box-sizing: border-box;
    color: #363b3e;
    cursor: pointer;
    display: flex;
    font-size: 14px;
    font-weight: 400;
    justify-content: left;
    min-height: 44px;
    padding: 5px 10px;
    position: relative;
    transition: 0.2s;
    width: 100%;
  }

  .select-pure__options {
    border-radius: 4px;
    border: 1px solid rgba(0, 0, 0, 0.15);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
    box-sizing: border-box;
    color: #363b3e;
    display: none;
    left: 0;
    max-height: 221px;
    overflow-y: scroll;
    position: absolute;
    top: 50px;
    width: 100%;
    z-index: 5;
  }

  .select-pure__select--opened .select-pure__options {
    display: block;
  }

  .select-pure__option {
    background: #fff;
    border-bottom: 1px solid #e4e4e4;
    box-sizing: border-box;
    height: 44px;
    line-height: 25px;
    padding: 10px;
  }

  .select-pure__option--disabled {
    color: #e4e4e4;
  }

  .select-pure__option--selected {
    color: #e4e4e4;
    cursor: initial;
    pointer-events: none;
  }

  .select-pure__option--hidden {
    display: none;
  }

  .select-pure__selected-label {
    font-size: 12px;
    align-items: 'center';
    background: teal;
    border-radius: 4px;
    color: #fff;
    cursor: initial;
    display: inline-flex;
    justify-content: 'center';
    margin: 5px 10px 5px 0;
    padding: 3px 7px;
  }

  .select-pure__selected-label:last-of-type {
    margin-right: 0;
  }

  .select-pure__selected-label i {
    cursor: pointer;
    display: inline-block;
    margin-left: 7px;
  }

  .select-pure__selected-label img {
    cursor: pointer;
    display: inline-block;
    height: 18px;
    margin-left: 7px;
    width: 14px;
  }

  .select-pure__selected-label i:hover {
    color: #e4e4e4;
  }

  .select-pure__autocomplete {
    background: #f9f9f8;
    border-bottom: 1px solid #e4e4e4;
    border-left: none;
    border-right: none;
    border-top: none;
    box-sizing: border-box;
    font-size: 16px;
    outline: none;
    padding: 10px;
    width: 100%;
  }

  .select-pure__placeholder--hidden {
    display: none;
  }

  .form-upload input[type="file"] {
    width: 120px;
    z-index: 999;
    opacity: 0;
  }
</style>
<div class="col">
  <div class="card">
    <!-- Card header -->
    <div class="card-header border-0">
      <h3 class="mb-0">SẢN PHẨM</h3>
    </div>
    <div class="row">

      <% categories.forEach(item=> { %>
        <div class="col-4">
          <div class="card-body position-relative">
                <div>
                  <div class="card" data-toggle="modal" data-target="#roomModal-<%= item.id %> "
                    style="cursor: pointer; box-shadow: 1px 0px 3px 1px #8080805c">
                    <!-- Card body -->
                    <div class="card-body">
                      <div class="row">
                        <div class="col">
                           <div class="d-flex justify-content-between">
                             <div>
                               <h5 class="card-title text-uppercase text-muted mb-0">
                                 <%= item.categoryName %>
                               </h5>
                               <span class="h2 font-weight-bold mb-0">
                                 <%= item.code %>
                               </span>
                             </div>
                             <div>
                               <img style="width: 50px; height: 50px; border-radius: 5px;" src="<%= item.thumbnail %>" alt="">
                             </div>
                           </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
          </div>
        </div>

        <% }) %>


    </div>
    <!-- Card footer -->
    <div class="card-footer py-4">
      <nav aria-label="...">
        <ul class="pagination justify-content-end mb-0">
          <% for (i=1; i <=total; i ++) { %>
            <% if(curentPage==i) { %>
              <li class="page-item active">
                <% if (q !='' || filter !='' ) { %>
                  <a class="page-link"
                    href="/admin/room/search?q=<%= q.replace(/%/g,'') %>&filterStatus=<%=filter%>&page=<%= i %>">
                    <%= i %>
                  </a>
                  <% } else { %>
                    <a class="page-link" href="/admin/room/?page=<%= i %>">
                      <%= i %>
                    </a>
                    <% } %>

              </li>
              <%} else { %>
                <li class="page-item">

                  <% if (q !='' || filter !='' ) { %>
                    <a class="page-link"
                      href="/admin/room/search?q=<%= q.replace(/%/g,'') %>&filterStatus=<%=filter%>&page=<%= i %>">
                      <%= i %>
                    </a>
                    <% } else { %>
                      <a class="page-link" href="/admin/room/?page=<%= i %>">
                        <%= i %>
                      </a>
                      <% } %>
                </li>
                <%} %>
                  <% } %>
        </ul>
      </nav>
    </div>
  </div>
</div>


<!-- THÊM -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="box-loading load-modal" style="display: none;">
    <div class="loadingio-spinner-rolling-lwtpylw27h">
      <div class="ldio-5lswg297lfp">
        <div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-dialog modal-dialog-centered mw-100" style="width: 55%" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">THÊM SẢN PHẨM</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form method="POST" class="create-item" action="/admin/room/create">
        <div class="modal-body">
          <div class="row">
            <div class="col">
              <h3 class="mb-4">Thông tin sản phẩm</h3>
              <form action="" method="POST">
                <div class="form-group">
                  <label for="example-text-input" class="form-control-label">Tiêu đề</label>
                  <input name="title" class="form-control" type="text" id="example-text-input">
                </div>
                <div class="form-group">
                  <label for="example-text-input" class="form-control-label">Loại sản phẩm</label>
                  <select name="categoryId" class="form-control">
                    <% roomCategories.forEach(element=> { %>

                      <option value="<%= element.id %> ">
                        <%= element.name %>
                      </option>
                      <% }) %>
                  </select>
                </div>
                <div class="form-group">
                  <label for="example-text-input" class="form-control-label">Giá sản phẩm</label>
                  <input name="price" class="form-control" type="text" id="example-text-input">
                </div>
                <div class="form-group">
                  <label for="example-text-input" class="form-control-label">Thông tin thêm</label>
                  <textarea class="editor" name="description">
               </textarea>
                </div>
                <div class="form-group">
                  <div class="form-upload d-flex flex-start position-relative">
                    <input type="hidden" name="thumbnail">
                    <input type="file" class="position-absolute">
                    <button type="button" class="btn btn-primary btn-rounded btn-sm"
                      style="width:120px; cursor: pointer; ">Ảnh đại diện</button><br>
                  </div>
                  <div class="text-center my-2 position-relative">
                    <span class="d-inline-block" style="width:100px; height:100px; border: 1px dotted gray">
                      <img class="mt-2" id="profile-thumbnail" style="width:80px">
                    </span>
                  </div>
                </div>
                <div class="form-group">
                  <label for="example-text-input" class="form-control-label">Hình ảnh</label>
                  <div class="text-center my-3 d-flex justify-content-around">
                    <input type="hidden" name="images" id="images">
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img class="images mt-2" style="margin:0 10px; width:80px">
                    </span>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img class="images mt-2" style="margin:0 10px; width:80px">
                    </span>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img class="images mt-2" style="margin:0 10px; width:80px">
                    </span>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img class="images mt-2" style="margin:0 10px; width:80px">
                    </span>
                  </div>
                  <div class="text-center my-3 d-flex justify-content-around">
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img class="images mt-2" style="margin:0 10px; width:80px">
                    </span>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img class="images mt-2" style="margin:0 10px; width:80px">
                    </span>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img class="images mt-2" style="margin:0 10px; width:80px">
                    </span>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img class="images mt-2" style="margin:0 10px; width:80px">
                    </span>
                  </div>
                  <div class="py-3 text-center">
                    <div class="position-relative">
                      <div class="position-absolute" style="
                                 top: 50%;
                                 left: 50%;
                                 transform: translate(-50%,-50%);
                                 width: 100px;
                                 cursor: pointer;
                                 height: 100%;
                             ">
                        <form class="form-upload h-100 d-block" action="/admin/upload?path=admin" method="POST"
                          enctype="multipart/form-data">
                          <div class="h-100">
                            <input id="i-images" type="file" name="file" style="
                                       display: block;
                                       height: 100%;
                                       width: 100%;
                                       opacity: 0;
                                       cursor: pointer;
                                   ">
                          </div>
                        </form>
                      </div>
                      <div>
                        <i class="fas fa-file-upload ni-3x" style="font-size: 30px;"></i>
                        <div>
                          <span id="excel-name" style="font-size: 12px" class="text-primary"></span>
                        </div>
                      </div>
                    </div>
                    <h4 class="heading mt-3">Tải lên hình ảnh</h4>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
          <button onclick="onLoadingModal(event)" type="submit" class="btn btn-primary">Lưu</button>
        </div>
        </div>
      </form>
    </div>
  </div>
</div>

<% categories.forEach(item=> { %>
  <!-- ROOM MODAL -->
  <div class="modal fade" id="roomModal-<%= item.id %>" tabindex="-1" role="dialog" aria-labelledby="roomModalLabel"
    aria-hidden="true">
    <div class="modal-dialog mw-100 modal-dialog-centered" role="document" style="width: 55%;">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="roomModalLabel">
            <%= item.code %>
          </h5>
          <span class="ml-2">
            <div class="d-flex justify-content-between">


                          <span class="text-nowrap text-prikmary" style="font-size: 14px; margin-left: 10px;"><i
                            class="fas fa-clock"></i>
                          <%= moment(item.timeOrderActive).locale('vi').fromNow() %>
                        </span>
        </div>
        </span>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <div class="row">
          <div class="col">
            <h3 class="mb-4">Thông tin sản phẩm</h3>
            <form id="item-update" action="/admin/room/update" method="POST">
              <div class="form-group">
                <input name="id" class="form-control" type="hidden"  value="<%=item.id%>">
              </div>
              <div class="form-group">
                <label for="example-text-input" class="form-control-label">Tiêu đề</label>
                <input name="title" class="form-control" type="text" value="<%= item.title %> " id="example-text-input">
              </div>
              <div class="form-group">
                <label for="example-text-input" class="form-control-label">Loại sản phẩm</label>
                <select name="categoryId" class="form-control">
                  <% roomCategories.forEach(element=> { %>
                    <% if (element.id==item.categoryId ) { %>
                      <option value="<%= element.id %>" selected>
                        <%= element.name %>
                      </option>
                      <% } %>
                        <% if (element.id !=item.categoryId) { %>
                          <option value="<%= element.id %> ">
                            <%= element.name %>
                          </option>
                          <% } %>
                            <% }) %>
                </select>
              </div>
              <div class="form-group">
                <label for="example-text-input" class="form-control-label">Giá sản phẩm</label>
                <input name="price" class="form-control" type="text" value="<%= item.price %> " id="example-text-input">
              </div>
              <div class="form-group">
                <label for="example-text-input" class="form-control-label">Thông tin thêm</label>
                <textarea class="editor" name="description">
                    <%= item.description %> 
                  </textarea>
              </div>
              <div class="form-group">
                <div class="form-upload d-flex flex-start position-relative">
                  <input type="hidden" asp-for="Thumbnail" value="">
                  <input type="file" class="position-absolute">
                  <button type="button" class="btn btn-primary btn-rounded btn-sm"
                    style="width:120px; cursor: pointer; ">Ảnh đại diện</button><br>
                </div>
                <div class="text-center my-2 position-relative">
                  <span class="d-inline-block" style="width:100px; height:100px; border: 1px dotted gray">
                    <img src="<%= item.thumbnail %> " class="mt-2" style="width:80px">
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label for="example-text-input" class="form-control-label">Hình ảnh</label>
                <div class="text-center my-3 d-flex justify-content-around">

                  <% const images=item.images.split(","); %>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img src="<%= images[0] %> " class=" mt-2" style="margin:0 10px; width:80px">
                    </span>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img src="<%= images[1] %> " class=" mt-2" style="margin:0 10px; width:80px">
                    </span>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img src="<%= images[2] %> " class=" mt-2" style="margin:0 10px; width:80px">
                    </span>
                    <span class="d-inline-block"
                      style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                      <img src="<%= images[3] %> " class=" mt-2" style="margin:0 10px; width:80px">
                    </span>
                </div>
                <div class="text-center my-3 d-flex justify-content-around">
                  <span class="d-inline-block"
                    style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                    <img src="<%= images[4] %> " class=" mt-2" style="margin:0 10px; width:80px">
                  </span>
                  <span class="d-inline-block"
                    style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                    <img src="<%= images[5] %> " class=" mt-2" style="margin:0 10px; width:80px">
                  </span>
                  <span class="d-inline-block"
                    style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                    <img src="<%= images[6] %> " class=" mt-2" style="margin:0 10px; width:80px">
                  </span>
                  <span class="d-inline-block"
                    style="margin:0 10px; width:100px; height:100px; border: 1px dotted gray">
                    <img src="<%= images[7] %> " class=" mt-2" style="margin:0 10px; width:80px">
                  </span>
                </div>
                <div class="py-3 text-center">
                  <div class="position-relative">
                    <div class="position-absolute" style="
                                    top: 50%;
                                    left: 50%;
                                    transform: translate(-50%,-50%);
                                    width: 100px;
                                    cursor: pointer;
                                    height: 100%;
                                ">
                      <form class="h-100 d-block" action="/admin/upload?path=admin" method="POST"
                        enctype="multipart/form-data">
                        <div class="h-100">
                          <input type="file" name="file" style="
                                          display: block;
                                          height: 100%;
                                          width: 100%;
                                          opacity: 0;
                                          cursor: pointer;
                                      ">
                        </div>
                      </form>
                    </div>
                    <div>
                      <i class="fas fa-file-upload ni-3x" style="font-size: 30px;"></i>
                      <div>
                        <span id="excel-name" style="font-size: 12px" class="text-primary"></span>
                      </div>
                    </div>
                  </div>
                  <h4 class="heading mt-3">Tải lên hình ảnh</h4>
                </div>
              </div>
            </form>
          </div>
          <div class="col">
            <h3 class="mb-4">Lịch sử mua sản phẩm</h3>
            <% item.orders.forEach((order,index)=> { %>
              <% let status=order.orderStatus; let classOrderStatus="success" ; let titleOrderStatus="thành công" ;
                if(status==3){ classOrderStatus="warning" ; titleOrderStatus="chưa xử lý" } else if(status==2){
                classOrderStatus="danger" ; titleOrderStatus="hủy" } %>
                <div id="accordion" style="margin-bottom:1px">
                  <div>
                    <div class="alert alert-<%= classOrderStatus %>  py-2 mb-0" style="border-radius: 0;" role="alert">
                      <div style="cursor: pointer;" data-toggle="collapse" data-target="#collapseOne-<%= order.id %>"
                        aria-expanded="true" aria-controls="collapseOne-<%= order.id %>">
                        <%= order.orderCode %> - <%= moment(order.orderCreateTime).format("DD/MM/YYYY") %>
                      </div>
                    </div>
                    <div id="collapseOne-<%= order.id %>"
                      class="position-relative collapse <%= index == 0 ? 'show' : '' %> " aria-labelledby="headingOne"
                      data-parent="#accordion">
                      <div class="py-1 px-1">
                        <span class="badge badge-pill badge-<%= classOrderStatus %>  mb-1"
                          style="border-radius: 0; padding-top: 7px;">
                          <%= titleOrderStatus %>
                        </span>
                        <div class="d-flex align-items-center">
                          <i class="fas fa-user" style="width: 25px"></i>
                          <p class="mb-0" style="font-size:14px; color: #8898aa">
                            <%= order.customerFullname %>
                          </p>
                        </div>
                        <div class="d-flex align-items-center">
                          <i class="fas fa-map-marker-alt" style="width: 25px"></i>
                          <p class="mb-0" style="font-size:14px; color: #8898aa">
                            <%= order.customerAddress %>
                          </p>
                        </div>
                        <div class="d-flex align-items-center">
                          <i class="fas fa-dollar-sign" style="width: 25px"></i>
                          <P class="mb-0" style="font-size:14px; color: #8898aa">
                            <%= order.orderAmount.toLocaleString('vi-VN', { style: 'currency' , currency: 'VND' }) %>
                          </p>
                        </div>
                        <div class="d-flex align-items-center">
                          <i class="fas fa-phone-square-alt" style="width: 25px"></i>
                          <p class="mb-0" style="font-size:14px; color: #8898aa">
                            <%= order.customerPhone %>
                          </p>
                        </div>
                        <div class="position-absolute" style="bottom:0px; right: 0; font-size: 13px;">
                          <a class="text-primary" href="/admin/order?action=update&orderId=<%= order.id %>">>> chi
                            tiết</a>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>

                <% }) %>

          </div>
        </div>
      </div>
      <div class="d-flex justify-content-between p-3">
        <div>
          <a class="text-danger" href="/admin/room/delete/<%= item.id %>">Xóa sản phẩm</a>
        </div>
        <div>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
          <button type="button" class="btn btn-primary" onclick="updateItem()">Lưu</button>
        </div>
      </div>
    </div>
  </div>
  </div>

  <% }) %>

  
    <script>

      // loading
      const loadingData = document.querySelector('.box-loading.load-data');
      const loadingModal = document.querySelector('.box-loading.load-modal');
      const formPost = document.querySelector('form[method=POST].create-item');

      function onLoadingModal(event) {
        event.preventDefault();
        loadingModal.style.display = 'flex';
        setTimeout(() => {
          loadingModal.style.display = 'none';
          formPost.submit();
        }, 500);
      }

      function reload() {
        window.location.href = "/admin/room"
      }
      // upload thumbnail 
      function uploadThumbnail() {
        let inputEditThumbnail = document.querySelector('.form-upload input[type="file"]');
        let thumbnailUrl = document.querySelector('input[name="thumbnail"]');
        inputEditThumbnail.addEventListener('change', function () {
          let Thumbnail = document.querySelector('#profile-thumbnail');

          var url = "/admin/upload?path=admin";
          var formData = new FormData();
          formData.append("file", inputEditThumbnail.files[0]);
          fetch(url, {
            method: 'POST',
            body: formData
          })
            .then(response => response.json())
            .then(data => {
              data.path = data.path.replace('/resources', '');
              Thumbnail.setAttribute("src", data.path);
              thumbnailUrl.value = data.path;
            })
            .catch(err => {
              console.log(err);
            })
        })
      }
      uploadThumbnail();
      // upload multiple images
      function uploadImages() {
        let inputUploadImages = document.querySelector('#i-images');
        let dataImages = [];
        let imageUrls = document.querySelector('input[name="CarImages"]');
        let images = document.querySelectorAll('.images');
        let indexImages = 0;
        const inputImages = document.querySelector('#images');
        inputUploadImages.addEventListener('change', function () {
          if (indexImages > 7) {
            return;
          }
          else {
            let Thumbnail = document.querySelector('#profile-thumbnail');

            var url = "/admin/upload?path=admin";
            var formData = new FormData();
            formData.append("file", inputUploadImages.files[0]);
            fetch(url, {
              method: 'POST',
              body: formData
            })
              .then(response => response.json())
              .then(data => {

                //dataImages.push({url: data.thumbnail, size: data.fileSize});
                //imageUrls.value = JSON.stringify(dataImages);
                data.path = data.path.replace('/resources', '');

                inputImages.value += "," + data.path;
                inputImages.value = inputImages.value.substring(1);

                images[indexImages].setAttribute("src", data.path);
                input = document.createElement('input');
                input.type = 'hidden';
                input.value = data.path;
                input.name = "images[" + indexImages + "].url";
                images[indexImages].after(input);
                input = document.createElement('input');
                input.type = 'hidden';
                input.value = data.fileSize;
                input.name = "images[" + indexImages + "].size";
                images[indexImages].after(input);
                indexImages++;
              })
              .catch(err => {
                console.log(err);
              })
          }
        })
      }
      uploadImages();
      const editors = document.querySelectorAll('.editor');
      editors.forEach(item => {
        ClassicEditor
          .create(item, {
            toolbar: ['heading', '|', 'bold', 'italic', 'link', 'bulletedList', 'numberedList', 'blockQuote'],
            heading: {
              options: [
                { model: 'paragraph', title: 'Paragraph', class: 'ck-heading_paragraph' },
                { model: 'heading1', view: 'h1', title: 'Heading 1', class: 'ck-heading_heading1' },
                { model: 'heading2', view: 'h2', title: 'Heading 2', class: 'ck-heading_heading2' }
              ]
            }
          })
          .catch(error => {
            console.log(error);
          });
      })

      // select option create

      // utilities 

      const utilities = document.querySelector('#utilities');

      let autocomplete = new SelectPure(`#autocomplete-select-add`, {
        options: [
          {
            label: "Điều hòa",
            value: "dh",
          },
          {
            label: "Quạt cháy",
            value: "qc",
          },
          {
            label: "Máy bơm",
            value: "mb",
          },

        ],
        value: ['dh'],
        multiple: true,
        autocomplete: true,
        icon: "fa fa-times",
        onChange: value => {
          utilities.value = value;
        },
        classNames: {
          select: "select-pure__select",
          dropdownShown: "select-pure__select--opened",
          multiselect: "select-pure__select--multiple",
          label: "select-pure__label",
          placeholder: "select-pure__placeholder",
          dropdown: "select-pure__options",
          option: "select-pure__option",
          autocompleteInput: "select-pure__autocomplete",
          selectedLabel: "select-pure__selected-label",
          selectedOption: "select-pure__option--selected",
          placeholderHidden: "select-pure__placeholder--hidden",
          optionHidden: "select-pure__option--hidden",
        }
      });
      let resetAutocomplete = function () {
        autocomplete.reset();
      };

      // select option detail




      // DATE PICKER 

      const startDate = document.querySelector('input[name="startDate"]');
      const endDate = document.querySelector('input[name="endDate"]');
      const now = moment().format("DD/MM/yyyy");
      const fromDate = moment().subtract(7, 'days').format("DD/MM/yyyy");
      // startDate.value = fromDate;
      // endDate.value = now;

      // notifycation
      toastr.options = {
        "closeButton": false,
        "debug": false,
        "newestOnTop": true,
        "progressBar": false,
        "positionClass": "toast-top-right",
        "preventDuplicates": false,
        "onclick": null,
        "showDuration": "300",
        "hideDuration": "1000",
        "timeOut": "5000",
        "extendedTimeOut": "1000",
        "showEasing": "swing",
        "hideEasing": "linear",
        "showMethod": "fadeIn",
        "hideMethod": "fadeOut"
      };
  

    

        <% if (errorValidate) { %>
              const err = '<%= errorValidate %>';
          toastr["error"]("<%= errorValidate %>")

            <%}%>
                  <% if (successAlert) { %>
        toastr["success"]("<%= successAlert %>")
        <%}%>


          let autocompleteSelects = document.querySelectorAll('.autocomplete-select');
      autocompleteSelects.forEach(item => {
        const itemId = item.dataset.selectId;

        let optionSelected = item.dataset.options?.trim()?.split(",");
        let autocomplete = new SelectPure(`#autocomplete-select-${itemId}`, {
          options: [
            {
              label: "Điều hòa",
              value: "dh",
            },
            {
              label: "Quạt cháy",
              value: "qc",
            },
            {
              label: "Máy bơm",
              value: "mb",
            },

          ],
          value: optionSelected,
          multiple: true,
          autocomplete: true,
          icon: "fa fa-times",
          onChange: value => { console.log(value); },
          classNames: {
            select: "select-pure__select",
            dropdownShown: "select-pure__select--opened",
            multiselect: "select-pure__select--multiple",
            label: "select-pure__label",
            placeholder: "select-pure__placeholder",
            dropdown: "select-pure__options",
            option: "select-pure__option",
            autocompleteInput: "select-pure__autocomplete",
            selectedLabel: "select-pure__selected-label",
            selectedOption: "select-pure__option--selected",
            placeholderHidden: "select-pure__placeholder--hidden",
            optionHidden: "select-pure__option--hidden",
          }
        });
        let resetAutocomplete = function () {
          autocomplete.reset();
        };
      })
    </script>
    <script>
      
      function getParameterByName(name, url = window.location.href) {
              name = name.replace(/[\[\]]/g, '\\$&');
              const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(url);
              if (!results) return null;
              if (!results[2]) return '';
              return decodeURIComponent(results[2].replace(/\+/g, ' '));
            }

            const action = getParameterByName('action');
            switch (action) {
              case "detail":
                const roomId = getParameterByName('roomId');
                $(`#roomModal-${roomId}`).modal();
                break;
              default:
                break;
            }

    </script>
    <script>
      // verify 
      function sendVerify(room) {
        console.log(room,'room');
        const creatorId = room.roomUserId;
        const id = room.id;
        fetch(`/admin/room/verify/${id}?creatorId=${creatorId}`)
          .then(response => response.json())
          .then(data => {
            if(data.status == 0){
              toastr["success"]("Gửi yêu cầu xác thực thành công");
            }
            else{
              toastr["warning"]("Yêu cầu xác thực đang được xử lý");
            }
          })
          .catch(err => {
            toastr["error"](error.message)
          })

      }

    </script>
    <script>
      const formUpdate = document.querySelector('#item-update')
      function updateItem(){
        formUpdate.submit();
      }
    </script>